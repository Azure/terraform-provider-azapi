[{"1":{"Kind":1}},{"1":{"Kind":2}},{"1":{"Kind":3}},{"1":{"Kind":4}},{"1":{"Kind":5}},{"1":{"Kind":6}},{"1":{"Kind":7}},{"1":{"Kind":8}},{"6":{"Value":"Microsoft.Security/securityConnectors"}},{"6":{"Value":"2021-12-01-preview"}},{"2":{"Name":"Microsoft.Security/securityConnectors","Properties":{"id":{"Type":4,"Flags":10,"Description":"The resource id"},"name":{"Type":4,"Flags":9,"Description":"The resource name"},"type":{"Type":8,"Flags":10,"Description":"The resource type"},"apiVersion":{"Type":9,"Flags":10,"Description":"The resource api version"},"systemData":{"Type":11,"Flags":2,"Description":"Azure Resource Manager metadata containing createdBy and modifiedBy information."},"properties":{"Type":22,"Flags":0,"Description":"Security connector data"},"location":{"Type":4,"Flags":0,"Description":"Location where the resource is stored"},"kind":{"Type":4,"Flags":0,"Description":"Kind of the resource"},"etag":{"Type":4,"Flags":0,"Description":"Entity tag is used for comparing two or more entities from the same requested resource."},"tags":{"Type":101,"Flags":0,"Description":"A list of key value pairs that describe the resource."}}}},{"2":{"Name":"SystemData","Properties":{"createdBy":{"Type":4,"Flags":0,"Description":"The identity that created the resource."},"createdByType":{"Type":16,"Flags":0,"Description":"The type of identity that created the resource."},"createdAt":{"Type":4,"Flags":0,"Description":"The timestamp of resource creation (UTC)."},"lastModifiedBy":{"Type":4,"Flags":0,"Description":"The identity that last modified the resource."},"lastModifiedByType":{"Type":21,"Flags":0,"Description":"The type of identity that last modified the resource."},"lastModifiedAt":{"Type":4,"Flags":0,"Description":"The timestamp of resource last modification (UTC)"}}}},{"6":{"Value":"User"}},{"6":{"Value":"Application"}},{"6":{"Value":"ManagedIdentity"}},{"6":{"Value":"Key"}},{"5":{"Elements":[12,13,14,15,4]}},{"6":{"Value":"User"}},{"6":{"Value":"Application"}},{"6":{"Value":"ManagedIdentity"}},{"6":{"Value":"Key"}},{"5":{"Elements":[17,18,19,20,4]}},{"2":{"Name":"SecurityConnectorProperties","Properties":{"hierarchyIdentifier":{"Type":4,"Flags":0,"Description":"The multi cloud resource identifier (account id in case of AWS connector, project number in case of GCP connector)."},"environmentName":{"Type":27,"Flags":0,"Description":"The multi cloud resource's cloud name."},"offerings":{"Type":80,"Flags":0,"Description":"A collection of offerings for the security connector."},"environmentData":{"Type":81,"Flags":0,"Description":"The security connector environment data."}}}},{"6":{"Value":"Azure"}},{"6":{"Value":"AWS"}},{"6":{"Value":"GCP"}},{"6":{"Value":"Github"}},{"5":{"Elements":[23,24,25,26,4]}},{"7":{"Name":"CloudOffering","Discriminator":"offeringType","BaseProperties":{"description":{"Type":4,"Flags":2,"Description":"The offering description."}},"Elements":{"CspmMonitorAws":29,"CspmMonitorGcp":32,"CspmMonitorGithub":35,"DefenderForContainersAws":37,"DefenderForContainersGcp":43,"DefenderForServersAws":47,"DefenderForServersGcp":62,"InformationProtectionAws":77}}},{"2":{"Name":"CspmMonitorAwsOffering","Properties":{"nativeCloudConnection":{"Type":30,"Flags":0,"Description":"The native cloud connection configuration"},"offeringType":{"Type":31,"Flags":1,"Description":"The type of the security offering."}}}},{"2":{"Name":"CspmMonitorAwsOfferingNativeCloudConnection","Properties":{"cloudRoleArn":{"Type":4,"Flags":0,"Description":"The cloud role ARN in AWS for this feature"}}}},{"6":{"Value":"CspmMonitorAws"}},{"2":{"Name":"CspmMonitorGcpOffering","Properties":{"nativeCloudConnection":{"Type":33,"Flags":0,"Description":"The native cloud connection configuration"},"offeringType":{"Type":34,"Flags":1,"Description":"The type of the security offering."}}}},{"2":{"Name":"CspmMonitorGcpOfferingNativeCloudConnection","Properties":{"workloadIdentityProviderId":{"Type":4,"Flags":0,"Description":"The GCP workload identity provider id for the offering"},"serviceAccountEmailAddress":{"Type":4,"Flags":0,"Description":"The service account email address in GCP for this offering"}}}},{"6":{"Value":"CspmMonitorGcp"}},{"2":{"Name":"CspmMonitorGithubOffering","Properties":{"offeringType":{"Type":36,"Flags":1,"Description":"The type of the security offering."}}}},{"6":{"Value":"CspmMonitorGithub"}},{"2":{"Name":"DefenderForContainersAwsOffering","Properties":{"kubernetesService":{"Type":38,"Flags":0,"Description":"The kubernetes service connection configuration"},"kubernetesScubaReader":{"Type":39,"Flags":0,"Description":"The kubernetes to scuba connection configuration"},"cloudWatchToKinesis":{"Type":40,"Flags":0,"Description":"The cloudwatch to kinesis connection configuration"},"kinesisToS3":{"Type":41,"Flags":0,"Description":"The kinesis to s3 connection configuration"},"offeringType":{"Type":42,"Flags":1,"Description":"The type of the security offering."}}}},{"2":{"Name":"DefenderForContainersAwsOfferingKubernetesService","Properties":{"cloudRoleArn":{"Type":4,"Flags":0,"Description":"The cloud role ARN in AWS for this feature"}}}},{"2":{"Name":"DefenderForContainersAwsOfferingKubernetesScubaReader","Properties":{"cloudRoleArn":{"Type":4,"Flags":0,"Description":"The cloud role ARN in AWS for this feature"}}}},{"2":{"Name":"DefenderForContainersAwsOfferingCloudWatchToKinesis","Properties":{"cloudRoleArn":{"Type":4,"Flags":0,"Description":"The cloud role ARN in AWS for this feature"}}}},{"2":{"Name":"DefenderForContainersAwsOfferingKinesisToS3","Properties":{"cloudRoleArn":{"Type":4,"Flags":0,"Description":"The cloud role ARN in AWS for this feature"}}}},{"6":{"Value":"DefenderForContainersAws"}},{"2":{"Name":"DefenderForContainersGcpOffering","Properties":{"nativeCloudConnection":{"Type":44,"Flags":0,"Description":"The native cloud connection configuration"},"dataPipelineNativeCloudConnection":{"Type":45,"Flags":0,"Description":"The native cloud connection configuration"},"auditLogsAutoProvisioningFlag":{"Type":2,"Flags":0,"Description":"Is audit logs data collection enabled"},"defenderAgentAutoProvisioningFlag":{"Type":2,"Flags":0,"Description":"Is Microsoft Defender for Cloud Kubernetes agent auto provisioning enabled"},"policyAgentAutoProvisioningFlag":{"Type":2,"Flags":0,"Description":"Is Policy Kubernetes agent auto provisioning enabled"},"offeringType":{"Type":46,"Flags":1,"Description":"The type of the security offering."}}}},{"2":{"Name":"DefenderForContainersGcpOfferingNativeCloudConnection","Properties":{"serviceAccountEmailAddress":{"Type":4,"Flags":0,"Description":"The service account email address in GCP for this offering"},"workloadIdentityProviderId":{"Type":4,"Flags":0,"Description":"The GCP workload identity provider id for this offering"}}}},{"2":{"Name":"DefenderForContainersGcpOfferingDataPipelineNativeCloudConnection","Properties":{"serviceAccountEmailAddress":{"Type":4,"Flags":0,"Description":"The data collection service account email address in GCP for this offering"},"workloadIdentityProviderId":{"Type":4,"Flags":0,"Description":"The data collection GCP workload identity provider id for this offering"}}}},{"6":{"Value":"DefenderForContainersGcp"}},{"2":{"Name":"DefenderForServersAwsOffering","Properties":{"defenderForServers":{"Type":48,"Flags":0,"Description":"The Defender for servers connection configuration"},"arcAutoProvisioning":{"Type":49,"Flags":0,"Description":"The ARC autoprovisioning configuration"},"vaAutoProvisioning":{"Type":51,"Flags":0,"Description":"The Vulnerability Assessment autoprovisioning configuration"},"mdeAutoProvisioning":{"Type":56,"Flags":0,"Description":"The Microsoft Defender for Endpoint autoprovisioning configuration"},"subPlan":{"Type":57,"Flags":0,"Description":"configuration for the servers offering subPlan"},"offeringType":{"Type":61,"Flags":1,"Description":"The type of the security offering."}}}},{"2":{"Name":"DefenderForServersAwsOfferingDefenderForServers","Properties":{"cloudRoleArn":{"Type":4,"Flags":0,"Description":"The cloud role ARN in AWS for this feature"}}}},{"2":{"Name":"DefenderForServersAwsOfferingArcAutoProvisioning","Properties":{"enabled":{"Type":2,"Flags":0,"Description":"Is arc auto provisioning enabled"},"servicePrincipalSecretMetadata":{"Type":50,"Flags":0,"Description":"Metadata of Service Principal secret for autoprovisioning"}}}},{"2":{"Name":"DefenderForServersAwsOfferingArcAutoProvisioningServicePrincipalSecretMetadata","Properties":{"expiryDate":{"Type":4,"Flags":0,"Description":"expiration date of service principal secret"},"parameterStoreRegion":{"Type":4,"Flags":0,"Description":"region of parameter store where secret is kept"},"parameterNameInStore":{"Type":4,"Flags":0,"Description":"name of secret resource in parameter store"}}}},{"2":{"Name":"DefenderForServersAwsOfferingVaAutoProvisioning","Properties":{"enabled":{"Type":2,"Flags":0,"Description":"Is Vulnerability Assessment auto provisioning enabled"},"configuration":{"Type":52,"Flags":0,"Description":"configuration for Vulnerability Assessment autoprovisioning"}}}},{"2":{"Name":"DefenderForServersAwsOfferingVaAutoProvisioningConfiguration","Properties":{"type":{"Type":55,"Flags":0,"Description":"The Vulnerability Assessment solution to be provisioned. Can be either 'TVM' or 'Qualys'"}}}},{"6":{"Value":"Qualys"}},{"6":{"Value":"TVM"}},{"5":{"Elements":[53,54,4]}},{"2":{"Name":"DefenderForServersAwsOfferingMdeAutoProvisioning","Properties":{"enabled":{"Type":2,"Flags":0,"Description":"Is Microsoft Defender for Endpoint auto provisioning enabled"},"configuration":{"Type":0,"Flags":0,"Description":"configuration for Microsoft Defender for Endpoint autoprovisioning"}}}},{"2":{"Name":"DefenderForServersAwsOfferingSubPlan","Properties":{"type":{"Type":60,"Flags":0,"Description":"The available sub plans"}}}},{"6":{"Value":"P1"}},{"6":{"Value":"P2"}},{"5":{"Elements":[58,59,4]}},{"6":{"Value":"DefenderForServersAws"}},{"2":{"Name":"DefenderForServersGcpOffering","Properties":{"defenderForServers":{"Type":63,"Flags":0,"Description":"The Defender for servers connection configuration"},"arcAutoProvisioning":{"Type":64,"Flags":0,"Description":"The ARC autoprovisioning configuration"},"vaAutoProvisioning":{"Type":66,"Flags":0,"Description":"The Vulnerability Assessment autoprovisioning configuration"},"mdeAutoProvisioning":{"Type":71,"Flags":0,"Description":"The Microsoft Defender for Endpoint autoprovisioning configuration"},"subPlan":{"Type":72,"Flags":0,"Description":"configuration for the servers offering subPlan"},"offeringType":{"Type":76,"Flags":1,"Description":"The type of the security offering."}}}},{"2":{"Name":"DefenderForServersGcpOfferingDefenderForServers","Properties":{"workloadIdentityProviderId":{"Type":4,"Flags":0,"Description":"The workload identity provider id in GCP for this feature"},"serviceAccountEmailAddress":{"Type":4,"Flags":0,"Description":"The service account email address in GCP for this feature"}}}},{"2":{"Name":"DefenderForServersGcpOfferingArcAutoProvisioning","Properties":{"enabled":{"Type":2,"Flags":0,"Description":"Is arc auto provisioning enabled"},"configuration":{"Type":65,"Flags":0,"Description":"Configuration for ARC autoprovisioning"}}}},{"2":{"Name":"DefenderForServersGcpOfferingArcAutoProvisioningConfiguration","Properties":{"clientId":{"Type":4,"Flags":0,"Description":"The Azure service principal client id for agent onboarding"},"agentOnboardingServiceAccountNumericId":{"Type":4,"Flags":0,"Description":"The agent onboarding service account numeric id"}}}},{"2":{"Name":"DefenderForServersGcpOfferingVaAutoProvisioning","Properties":{"enabled":{"Type":2,"Flags":0,"Description":"Is Vulnerability Assessment auto provisioning enabled"},"configuration":{"Type":67,"Flags":0,"Description":"configuration for Vulnerability Assessment autoprovisioning"}}}},{"2":{"Name":"DefenderForServersGcpOfferingVaAutoProvisioningConfiguration","Properties":{"type":{"Type":70,"Flags":0,"Description":"The Vulnerability Assessment solution to be provisioned. Can be either 'TVM' or 'Qualys'"}}}},{"6":{"Value":"Qualys"}},{"6":{"Value":"TVM"}},{"5":{"Elements":[68,69,4]}},{"2":{"Name":"DefenderForServersGcpOfferingMdeAutoProvisioning","Properties":{"enabled":{"Type":2,"Flags":0,"Description":"Is Microsoft Defender for Endpoint auto provisioning enabled"},"configuration":{"Type":0,"Flags":0,"Description":"configuration for Microsoft Defender for Endpoint autoprovisioning"}}}},{"2":{"Name":"DefenderForServersGcpOfferingSubPlan","Properties":{"type":{"Type":75,"Flags":0,"Description":"The available sub plans"}}}},{"6":{"Value":"P1"}},{"6":{"Value":"P2"}},{"5":{"Elements":[73,74,4]}},{"6":{"Value":"DefenderForServersGcp"}},{"2":{"Name":"InformationProtectionAwsOffering","Properties":{"informationProtection":{"Type":78,"Flags":0,"Description":"The native cloud connection configuration"},"offeringType":{"Type":79,"Flags":1,"Description":"The type of the security offering."}}}},{"2":{"Name":"InformationProtectionAwsOfferingInformationProtection","Properties":{"cloudRoleArn":{"Type":4,"Flags":0,"Description":"The cloud role ARN in AWS for this feature"}}}},{"6":{"Value":"InformationProtectionAws"}},{"3":{"ItemType":28}},{"7":{"Name":"EnvironmentData","Discriminator":"environmentType","BaseProperties":{},"Elements":{"AwsAccount":82,"GcpProject":90,"GithubScope":99}}},{"2":{"Name":"AWSEnvironmentData","Properties":{"organizationalData":{"Type":83,"Flags":0,"Description":"The AWS account's organizational data"},"environmentType":{"Type":89,"Flags":1,"Description":"The type of the environment data."}}}},{"7":{"Name":"AwsOrganizationalData","Discriminator":"organizationMembershipType","BaseProperties":{},"Elements":{"Member":84,"Organization":86}}},{"2":{"Name":"AwsOrganizationalDataMember","Properties":{"parentHierarchyId":{"Type":4,"Flags":0,"Description":"If the multi cloud account is not of membership type organization, this will be the ID of the account's parent"},"organizationMembershipType":{"Type":85,"Flags":1,"Description":"The multi cloud account's membership type in the organization"}}}},{"6":{"Value":"Member"}},{"2":{"Name":"AwsOrganizationalDataMaster","Properties":{"stacksetName":{"Type":4,"Flags":0,"Description":"If the multi cloud account is of membership type organization, this will be the name of the onboarding stackset"},"excludedAccountIds":{"Type":87,"Flags":0,"Description":"If the multi cloud account is of membership type organization, list of accounts excluded from offering"},"organizationMembershipType":{"Type":88,"Flags":1,"Description":"The multi cloud account's membership type in the organization"}}}},{"3":{"ItemType":4}},{"6":{"Value":"Organization"}},{"6":{"Value":"AwsAccount"}},{"2":{"Name":"GcpProjectEnvironmentData","Properties":{"organizationalData":{"Type":91,"Flags":0,"Description":"The Gcp project's organizational data"},"projectDetails":{"Type":97,"Flags":0,"Description":"The Gcp project's details"},"environmentType":{"Type":98,"Flags":1,"Description":"The type of the environment data."}}}},{"7":{"Name":"GcpOrganizationalData","Discriminator":"organizationMembershipType","BaseProperties":{},"Elements":{"Member":92,"Organization":94}}},{"2":{"Name":"GcpOrganizationalDataMember","Properties":{"parentHierarchyId":{"Type":4,"Flags":0,"Description":"If the multi cloud account is not of membership type organization, this will be the ID of the project's parent"},"organizationMembershipType":{"Type":93,"Flags":1,"Description":"The multi cloud account's membership type in the organization"}}}},{"6":{"Value":"Member"}},{"2":{"Name":"GcpOrganizationalDataOrganization","Properties":{"excludedProjectNumbers":{"Type":95,"Flags":0,"Description":"If the multi cloud account is of membership type organization, list of accounts excluded from offering"},"serviceAccountEmailAddress":{"Type":4,"Flags":0,"Description":"The service account email address which represents the organization level permissions container."},"workloadIdentityProviderId":{"Type":4,"Flags":0,"Description":"The GCP workload identity provider id which represents the permissions required to auto provision security connectors"},"organizationMembershipType":{"Type":96,"Flags":1,"Description":"The multi cloud account's membership type in the organization"}}}},{"3":{"ItemType":4}},{"6":{"Value":"Organization"}},{"2":{"Name":"GcpProjectDetails","Properties":{"projectNumber":{"Type":4,"Flags":0,"Description":"The unique GCP Project number"},"projectId":{"Type":4,"Flags":0,"Description":"The GCP Project id"},"workloadIdentityPoolId":{"Type":4,"Flags":2,"Description":"The GCP workload identity federation pool id"}}}},{"6":{"Value":"GcpProject"}},{"2":{"Name":"GithubScopeEnvironmentData","Properties":{"environmentType":{"Type":100,"Flags":1,"Description":"The type of the environment data."}}}},{"6":{"Value":"GithubScope"}},{"2":{"Name":"Tags","Properties":{},"AdditionalProperties":4}},{"4":{"Name":"Microsoft.Security/securityConnectors@2021-12-01-preview","ScopeType":8,"Body":10}}]